(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/task/taskList/taskDetail/taskDetail"],{"0dac":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"21b6"))}},o=function(){var e=this,t=e.$createElement;e._self._c},s=[]},"1f3a":function(e,t,n){"use strict";n.r(t);var i=n("e863"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},"3b72":function(e,t,n){"use strict";var i=n("6434"),o=n.n(i);o.a},4354:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("a34a")),o=r(n("a95f")),s=n("6c29"),a=n("d160"),u=n("8b93");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n,i,o,s,a){try{var u=e[s](a),r=u.value}catch(c){return void n(c)}u.done?t(r):Promise.resolve(r).then(i,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var s=e.apply(t,n);function a(e){c(s,i,o,a,u,"next",e)}function u(e){c(s,i,o,a,u,"throw",e)}a(void 0)}))}}var d=function(){n.e("components/perFunctionInfo/leaveMess1/leaveMess").then(function(){return resolve(n("d2ae"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/helang-compress/helang-compress").then(function(){return resolve(n("d5f6"))}.bind(null,n)).catch(n.oe)},m={components:{LeaveMess:o.default,LeaveMess1:d,helangCompress:f},data:function(){return{truemoney:0,textFocus:!1,action:getApp().globalData.imgBaseUrl+"/common/upload/image.html",navTop:getApp().globalData.navTop,navHeight:getApp().globalData.navHeight,showliuyan:!1,showModal:!1,showReply:!1,userInfo:[{head:"/static/index/1.png",userName:"李优秀",gender:0,time:"10分钟前",userUniversity:"郑州大学",status:1,expressNum:5,price:10}],alldata:"",page:1,page1:1,liuList:[],allLiu:0,huiList:[],comment:"",img:[],fid:0,imgBaseUrl:getApp().globalData.imgBaseUrl,comment_up_id:0,placeholder:"",up_user_id:"",inform:"",juType:2,task_comment_id:"",inform_user_id:"",status:"loading",iconType:"flower",loadText:{loadmore:"轻轻上拉",loading:"努力加载中",nomore:"实在没有了"},is_Write1:!1,status1:"loading"}},methods:{onBottom:function(){if("nomore"==this.status1)return!1;this.getliu()},showWrite:function(t,n){var i=this;e.requestSubscribeMessage({tmplIds:["Q0dB1QJc9GcGSfT5tpj6GBbf53JiHhz6RDQZOVM6i3Y"],complete:function(e){i.is_Write1=!1,i.comment="",i.comment_up_id=0,i.img=[],i.$refs["uUpload"].clear(),void 0==t?(i.fid=0,i.up_user_id=i.alldata.user_id):(i.fid=t,i.up_user_id=n),i.showliuyan=!i.showliuyan}})},showWrite1:function(t,n,i){var o=this;e.requestSubscribeMessage({tmplIds:["Q0dB1QJc9GcGSfT5tpj6GBbf53JiHhz6RDQZOVM6i3Y"],complete:function(e){o.is_Write1=!0,o.img=[],o.$refs["uUpload"].clear(),o.placeholder="回复 @"+i+"：",o.comment="",o.comment_up_id=t,o.up_user_id=n,o.showliuyan=!o.showliuyan}})},getList:function(){var e=this;(0,s.listComment)({where:{task_id:this.alldata.id},limit:10,page:this.page}).then((function(t){200==t.code?(e.allLiu=t.result.count,e.liuList=e.liuList.concat(t.result.data),e.page++,t.result.count<=10&&(e.status="nomore")):e.status="nomore"}))},beforeUpload:function(t,n){var o=this;return l(i.default.mark((function s(){return i.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.showLoading({title:"检测中...",mask:!0}),s.prev=1,s.next=4,o.$refs.helangCompress.compress({src:n[t].url}).then(function(){var e=l(i.default.mark((function e(s){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.$check.checkImg1(t,s,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:s.next=9;break;case 6:s.prev=6,s.t0=s["catch"](1),console.log("e",s.t0);case 9:case"end":return s.stop()}}),s,null,[[1,6]])})))()},onSuccess:function(t,n,i,o){200==t.code?this.img.push({path:t.result.src}):e.showToast({title:t.message,icon:"none"})},onRemove:function(t,n){var i=this;(0,u.delImages)(this.img[t]).then((function(n){e.showToast({title:n.message,icon:"none"}),200==n.code&&i.img.splice(t,1)}))},toPraise:function(t,n,i,o,a){var u=this;(0,s.Praise)({data:{type:t,task_comment_id:n,praise_user_id:i,user_id:JSON.parse(e.getStorageSync("user")).id}}).then((function(e){200==e.code&&(0==a?1==t?(u.liuList[o].is_praise=!0,u.liuList[o].praise_count++,u.$forceUpdate()):(u.liuList[o].is_praise=!1,u.liuList[o].praise_count--,u.$forceUpdate()):1==t?(u.huiList[o].is_praise=!0,u.huiList[o].praise_count++,u.$forceUpdate()):(u.huiList[o].is_praise=!1,u.huiList[o].praise_count--,u.$forceUpdate()))}))},addComm:function(){var t=this;return l(i.default.mark((function n(){return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(""==t.comment&&t.img.length<1)){n.next=3;break}return e.showToast({title:"内容和图片至少选择一样评论",icon:"none"}),n.abrupt("return",!1);case 3:return n.prev=3,n.next=6,t.$check.checkTxt(t.comment);case 6:n.sent,n.next=13;break;case 9:return n.prev=9,n.t0=n["catch"](3),t.comment="",n.abrupt("return",!1);case 13:e.showLoading({title:"提交中……",mask:!0}),(0,s.insertComment)({task_id:t.alldata.id,data:{fid:t.fid,comment:t.comment,img:t.img,comment_up_id:t.comment_up_id,up_user_id:t.up_user_id}}).then((function(n){e.hideLoading(),e.showToast({title:n.message,icon:"none"}),200==n.code&&(t.showliuyan=!t.showliuyan,t.is_Write1?(t.page1=1,t.huiList=[],t.status1="loading",t.getliu()):(t.page=1,t.liuList=[],t.status="loading",t.getList()))}));case 15:case"end":return n.stop()}}),n,null,[[3,9]])})))()},moreBtn1:function(t,n){var i=this;e.showActionSheet({itemList:JSON.parse(e.getStorageSync("user")).id==n?["我要删除"]:["我要举报"],itemColor:JSON.parse(e.getStorageSync("user")).id==n?"#ff0000":"#000000",success:function(o){JSON.parse(e.getStorageSync("user")).id!=n?(i.inform="",i.juType=1,i.task_comment_id=t,i.inform_user_id=n,i.showModal=!i.showModal):e.showModal({title:"警告",content:"确定要删除该评论吗",success:function(n){n.confirm?(0,s.delComment)({id:t,user_id:JSON.parse(e.getStorageSync("user")).id}).then((function(t){e.showToast({title:t.message,icon:"none"}),i.status="loading",200==t.code&&(i.page=1,i.liuList=[],(0,s.listComment)({where:{task_id:i.alldata.id},limit:10,page:i.page}).then((function(e){200==e.code?(i.allLiu=e.result.count,i.liuList=i.liuList.concat(e.result.data),i.page++,i.showReply=!1,e.result.count<=10&&(i.status="nomore")):(i.allLiu=0,i.status="nomore")})))})):n.cancel}})},fail:function(e){console.log(e.errMsg)}})},moreBtn:function(t){var n=this;e.showActionSheet({itemList:["我要举报"],success:function(e){0==e.tapIndex&&(n.inform="",n.juType=2,n.showModal=!n.showModal)},fail:function(e){console.log(e.errMsg)}})},submit:function(){var t=this;if(""==this.inform)return e.showToast({title:"请输入举报内容",icon:"none"}),!1;var n={};1==this.juType?(n={task_comment_id:this.task_comment_id,inform_user_id:this.inform_user_id,inform:this.inform},(0,s.liuInform)({data:n}).then((function(n){e.showToast({title:n.message,icon:"none"}),200==n.code&&(t.showModal=!t.showModal)}))):(n={task_id:this.alldata.id,inform_user_id:this.alldata.user_id,inform:this.inform},(0,s.Inform)({data:n}).then((function(n){e.showToast({title:n.message,icon:"none"}),200==n.code&&(t.showModal=!t.showModal)})))},showhf:function(t){this.page1=1,this.huiList=[],this.fid=t,e.showLoading({title:"加载中"}),this.showReply=!this.showReply,this.getliu()},getliu:function(){var t=this;(0,s.listComment)({where:{fid:this.fid},limit:10,page:this.page1}).then((function(n){e.hideLoading(),200==n.code?(t.huiList=t.huiList.concat(n.result.data),t.page1++,n.result.count<=10&&(t.status1="nomore")):t.status1="nomore"}))},toMinePage:function(t){e.navigateTo({url:"/pages/community/minePage/minePage?id="+t})},showPop:function(t,n){var i=this,o=[];t.forEach((function(e){o.push(i.imgBaseUrl+e.path)})),e.previewImage({current:n,urls:o})},takeOrder:function(){var t=this;(0,a.findUserInfo)({}).then((function(n){200==n.code&&(e.setStorageSync("user",JSON.stringify(n.result)),1==n.result.is_rider.code&&n.result.credit>79?t.takeOrder1():1!=n.result.is_rider.code?e.showToast({title:"成为骑手后才能接任务!",duration:3e3,icon:"none"}):n.result.credit<80&&e.showToast({title:"信誉分过低无法接单!",duration:3e3,icon:"none"}))}))},takeOrder1:function(){var t=this;e.showModal({title:"温馨提示",content:"接单后未完成订单，将扣除您的信誉分，信誉分过低将无法接单。",cancelText:"取消",confirmText:"确认",confirmColor:"#FFDD05",success:function(n){n.cancel||n.confirm&&e.requestSubscribeMessage({tmplIds:["VkSklDJC5xONLGxOfWoJS1uWdVzBztd--rZasHzsMMI","RWiuB1VJcmw94MDR-sZVdUfUTkg7MwPOks4kpA45XxQ","TwDXAfPjCKJkjCR3s4IX_cYSjRdYTPBYp9sl7z6zRuc"],complete:function(n){e.showLoading({title:"接单中……",mask:!0}),(0,s.createOrder)({data:{task_id:t.alldata.id,task_user_id:t.alldata.user_id,task_type:t.alldata.type}}).then((function(t){e.hideLoading(),200==t.code?e.reLaunch({url:"/pages/mine/acceptOrder/orderDetail/orderDetail?id="+t.result.order_id}):e.showToast({title:t.message,icon:"none"})}))}})}})}},onReachBottom:function(){if("nomore"==this.status)return!1;this.status,this.getList()},onLoad:function(t){var n=this;e.showLoading({title:"加载中...",mask:!0}),(0,s.getInfoTask)({id:t.id}).then((function(t){e.hideLoading(),200==t.code&&(n.alldata=t.result,n.getList(),n.truemoney=n.$Numcheck.rounding(Number(n.alldata.true_urgent_price)+Number(n.alldata.good_prepay)+Number(n.alldata.money),2))}))}};t.default=m}).call(this,n("543d")["default"])},4766:function(e,t,n){"use strict";(function(e){n("394a");i(n("66fd"));var t=i(n("4bb2"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},4942:function(e,t,n){},"4bb2":function(e,t,n){"use strict";n.r(t);var i=n("8412"),o=n("4d3b");for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("3b72");var a,u=n("f0c5"),r=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"415d7dde",null,!1,i["a"],a);t["default"]=r.exports},"4d3b":function(e,t,n){"use strict";n.r(t);var i=n("4354"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);t["default"]=o.a},6434:function(e,t,n){},8412:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i}));var i={uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"21b6"))},uLoadmore:function(){return n.e("node-modules/uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"811d"))},uPopup:function(){return n.e("node-modules/uview-ui/components/u-popup/u-popup").then(n.bind(null,"d202"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"f218"))},helangCompress:function(){return n.e("components/helang-compress/helang-compress").then(n.bind(null,"d5f6"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.showModal=!1},e.e1=function(t){e.textFocus=!0},e.e2=function(t){e.textFocus=!1},e.e3=function(t){e.showReply=!e.showReply})},s=[]},a95f:function(e,t,n){"use strict";n.r(t);var i=n("0dac"),o=n("1f3a");for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);n("f958");var a,u=n("f0c5"),r=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,"c4657df0",null,!1,i["a"],a);t["default"]=r.exports},e863:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={props:{curHelpInfo:{type:Array,value:[]}},data:function(){return{imgBaseUrl:getApp().globalData.imgBaseUrl}},methods:{toMinePage:function(e){this.$emit("toMinePage",e)},moreBtn:function(e,t){this.$emit("moreBtn",e,t)},showPop:function(e,t){this.$emit("showPop",e,t)},showhf:function(e){this.$emit("showhf",e)},showWrite:function(e,t){this.$emit("showWrite",e,t)},praise:function(e,t,n,i,o){this.$emit("praise",e,t,n,i,o)}}};t.default=i},f958:function(e,t,n){"use strict";var i=n("4942"),o=n.n(i);o.a}},[["4766","common/runtime","common/vendor"]]]);