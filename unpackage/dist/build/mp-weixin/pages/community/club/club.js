(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/community/club/club"],{"07b3":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("a34a")),i=n("8b93");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,a,i,o,s){try{var u=t[o](s),c=u.value}catch(r){return void n(r)}u.done?e(c):Promise.resolve(c).then(a,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var o=t.apply(e,n);function u(t){s(o,a,i,u,c,"next",t)}function c(t){s(o,a,i,u,c,"throw",t)}u(void 0)}))}}var c=function(){n.e("components/helang-compress/helang-compress").then(function(){return resolve(n("d5f6"))}.bind(null,n)).catch(n.oe)},r={components:{helangCompress:c},data:function(){return{imgBaseUrl:getApp().globalData.imgBaseUrl,action:getApp().globalData.imgBaseUrl+"/common/upload/image.html",navTop:getApp().globalData.navTop,navHeight:getApp().globalData.navHeight,tabList:[{name:"最新",val:"new"},{name:"热门",val:"hot"}],active:"new",images:["/static/mine/name1.png"],showTab:!1,club_id:"",clubData:{},dataList:[],myId:null,page:1,status:"loadmore",iconType:"flower",loadText:{loadmore:"上拉或点击",loading:"努力加载中",nomore:"实在没有了"}}},onPageScroll:function(t){t.scrollTop>=100?this.showTab=!0:this.showTab=!1},onShareAppMessage:function(e){var n=this;return"button"===e.from&&(0,i.sharePosts)({id:e.target.dataset.id}).then((function(a){200==a.code&&(t.showToast({title:a.message,duration:1500}),n.dataList[e.target.dataset.index].share_num++)})),{title:"动态发布",path:"/pages/community/commDetail/commDetail?id="+e.target.dataset.id,imageUrl:"/static/dongtai/share_dt.png"}},onPullDownRefresh:function(){this.init(),t.stopPullDownRefresh()},onLoad:function(t){this.club_id=t.id,this.getData()},onShow:function(){var e=this;t.getStorage({key:"user",success:function(t){e.myId=JSON.parse(t.data).id}})},onReachBottom:function(){this.loadingMore()},methods:{init:function(){this.page=1,this.dataList=[],this.status="loadmore",this.getData(),this.clubData.is_join&&this.getList()},delPost:function(e){var n=this;t.showModal({title:"提示",content:"请确认进行此删除操作",success:function(a){a.confirm?(t.showLoading({title:"加载中...",mask:!0}),(0,i.delPosts)({id:e}).then((function(e){t.hideLoading(),t.showToast({title:e.message,icon:"none"}),200==e.code&&n.init()}))):a.cancel&&console.log("用户点击取消")}})},moreBtn:function(e,n){var a=this;t.showActionSheet({itemList:this.myId==n?["我要删除"]:["我要举报"],itemColor:this.myId==n?"#ff0000":"#000000",success:function(t){a.myId==n?a.delPost(e):a.showModal=!0},fail:function(t){}})},showPop:function(e,n){var a=this,i=[];e.forEach((function(t){i.push(a.imgBaseUrl+t.path)})),t.previewImage({current:n,urls:i})},like:function(e,n){var a=this;(0,i.praisePosts)({id:e}).then((function(e){a.dataList[n].is_praise=!a.dataList[n].is_praise,200==e.code?(a.dataList[n].praise_num++,t.showToast({title:e.message,icon:"none",duration:1500})):1==e.code?a.dataList[n].praise_num--:t.showToast({title:e.message,icon:"none",duration:1500})}))},loadingMore:function(){"nomore"!=this.status&&(this.status="loading",this.page=++this.page,this.getList())},getList:function(){var e=this;t.showLoading({title:"加载中...",mask:!0}),(0,i.getPostsLists)({where:{community_club_id:this.club_id,order:this.active},page:this.page,limit:10}).then((function(n){t.hideLoading(),200==n.code?e.dataList=e.dataList.concat(n.result):e.status="nomore"}))},changeBg:function(){if(!this.clubData.is_join||this.clubData.auth<1)return!1;var e=this;t.showActionSheet({itemList:["更换背景"],success:function(t){e.changeAvator()},fail:function(t){console.log(t.errMsg)}})},changeAvator:function(){var e=this,n=this;t.chooseImage({sizeType:["compressed"],sourceType:["album","camera"],success:function(o){t.showLoading({title:"检测中...",mask:!0});var s=o.tempFilePaths;e.$refs.helangCompress.compress({src:o.tempFilePaths[0]}).then(function(){var o=u(a.default.mark((function o(u){return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.$check.checkImg1(0,u,s);case 3:t.showLoading({title:"加载中..."}),t.uploadFile({url:n.action,filePath:s[0],name:"file",header:{token:t.getStorageSync("token")},success:function(e){var a=JSON.parse(e.data);200==a.code&&(0,i.editClubInfo)({id:n.club_id,data:{bg_img:a.result.src}}).then((function(e){t.hideLoading(),200==e.code?(n.$set(n.clubData,"bg_img",a.result.src),n.getData()):t.showToast({title:e.message,icon:"none"})}))}}),a.next=9;break;case 7:a.prev=7,a.t0=a["catch"](0);case 9:case"end":return a.stop()}}),o,null,[[0,7]])})));return function(t){return o.apply(this,arguments)}}()).catch((function(e){t.showToast({title:"上传失败"})}))}})},getData:function(){var e=this;t.showLoading({title:"加载中..."}),(0,i.getCulbInfo)({id:this.club_id}).then((function(n){t.hideLoading(),200==n.code?(e.clubData=n.result,e.clubData.is_join&&(e.dataList=[],e.getList())):t.showToast({title:n.message,icon:"none"})}))},addComm:function(){t.redirectTo({url:"/pages/community/addComm/addComm?type=2&club_id="+this.club_id})},toMinePage:function(e){t.navigateTo({url:"/pages/community/minePage/minePage?id="+e})},back:function(){t.navigateBack()},changeTab:function(t){this.active=t,this.status="loadmore",this.page=1,this.dataList=[],this.getList()},toDetail:function(e){t.navigateTo({url:"/pages/community/commDetail/commDetail?id="+e})},toclubDetail:function(){this.clubData.is_join&&0!=this.clubData.auth?t.navigateTo({url:"/pages/community/club/clubDetail/clubDetail1?id="+this.club_id}):t.navigateTo({url:"/pages/community/club/clubDetail/clubDetail?id="+this.club_id})}}};e.default=r}).call(this,n("543d")["default"])},"3f88":function(t,e,n){"use strict";n.r(e);var a=n("cd26"),i=n("8593");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("b65b");var s,u=n("f0c5"),c=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,"bd7e5094",null,!1,a["a"],s);e["default"]=c.exports},"64fb":function(t,e,n){},8593:function(t,e,n){"use strict";n.r(e);var a=n("07b3"),i=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},b65b:function(t,e,n){"use strict";var a=n("64fb"),i=n.n(a);i.a},be66:function(t,e,n){"use strict";(function(t){n("394a");a(n("66fd"));var e=a(n("3f88"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},cd26:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}));var a={uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"21b6"))},uEmpty:function(){return n.e("node-modules/uview-ui/components/u-empty/u-empty").then(n.bind(null,"9f84"))},uReadMore:function(){return n.e("node-modules/uview-ui/components/u-read-more/u-read-more").then(n.bind(null,"4de6"))},uLoadmore:function(){return n.e("node-modules/uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"811d"))},helangCompress:function(){return n.e("components/helang-compress/helang-compress").then(n.bind(null,"d5f6"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.clubData&&""!=t.clubData.club_name&&t.clubData&&""!=t.clubData.club_name&&t.clubData.is_join?t.__map(t.dataList,(function(e,n){var a=t.__get_orig(e),i=t.$u.timeFrom(e.create_time,!1);return{$orig:a,g0:i}})):null);t.$mp.data=Object.assign({},{$root:{l0:n}})},o=[]}},[["be66","common/runtime","common/vendor"]]]);