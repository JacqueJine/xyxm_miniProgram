(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/community/commSearch/commSearch"],{"1c6b":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i("8b93"),n={data:function(){return{imgBaseUrl:getApp().globalData.imgBaseUrl,action:getApp().globalData.imgBaseUrl+"/common/upload/image.html",value:"",active:0,navTop:getApp().globalData.navTop,navHeight:getApp().globalData.navHeight,tabList:["帖子","社团","用户"],images:["/static/mine/name1.png"],isguan:!1,focus:!0,searList:[],selText:0,phbList:[],dataList:[],userList:[],myId:null,page:1,status:"loadmore",iconType:"flower",loadText:{loadmore:"上拉或点击",loading:"努力加载中",nomore:"实在没有了"}}},onShareAppMessage:function(e){var i=this;return"button"===e.from&&(0,s.sharePosts)({id:e.target.dataset.id}).then((function(s){200==s.code&&(t.showToast({title:s.message,duration:1500}),i.dataList[e.target.dataset.index].share_num++)})),{title:"动态发布",path:"/pages/community/commDetail/commDetail?id="+e.target.dataset.id,imageUrl:"/static/dongtai/share_dt.png"}},onShow:function(){var e=this;t.getStorage({key:"user",success:function(t){e.myId=JSON.parse(t.data).id}})},onPullDownRefresh:function(){this.init(),t.stopPullDownRefresh()},onReachBottom:function(){this.loadingMore()},methods:{init:function(){this.page=1,this.dataList=[],this.phbList=[],this.userList=[],this.status="loadmore",0==this.active?this.getList():1==this.active?this.getPhb():2==this.active&&this.getUser()},loadingMore:function(){"nomore"!=this.status&&(this.status="loading",this.page=++this.page,0==this.active?this.getList():1==this.active?this.getPhb():2==this.active&&this.getUser())},getUser:function(){var e=this;t.showLoading({title:"加载中...",mask:!0}),(0,s.listUser)({where:{name:this.value},page:this.page,limit:10}).then((function(i){t.hideLoading(),200==i.code?e.userList=e.userList.concat(i.result.userList):e.status="nomore"}))},getList:function(){var e=this;t.showLoading({title:"加载中...",mask:!0}),(0,s.getPostsLists)({where:{posts_auth:this.selText,community_club_id:0,content:this.value},page:this.page,limit:10}).then((function(i){t.hideLoading(),200==i.code?e.dataList=e.dataList.concat(i.result):e.status="nomore"}))},getPhb:function(){var e=this;t.showLoading({title:"加载中...",mask:!0}),(0,s.getClubLists)({where:{club_auth:this.selText,club_name:this.value},page:this.page,limit:20}).then((function(i){200==i.code?i.result.list.length?e.phbList=e.phbList.concat(i.result.list):e.status="nomore":t.showToast({title:i.message,icon:"none"}),t.hideLoading()}))},changeSchool:function(){0==this.selText?this.selText=1:this.selText=0,this.init()},back:function(){t.navigateBack()},toSearch:function(t){if(1!=this.active&&""==t)return!1;this.value=t,this.focus=!1,this.init()},onFocus:function(){this.focus=!0},onSearch:function(){if(1!=this.active&&""==this.value)return!1;this.searList.unshift(this.value),this.searList=this.searList.filter((function(t,e,i){return i.indexOf(t)===e})),t.setStorage({key:"searchHistory",data:this.searList,success:function(){}}),this.focus=!1,this.init()},changeTab:function(t){this.active=t,this.onSearch()},delPost:function(e){var i=this;t.showModal({title:"提示",content:"请确认进行此删除操作",success:function(n){n.confirm?(t.showLoading({title:"加载中...",mask:!0}),(0,s.delPosts)({id:e}).then((function(e){t.hideLoading(),t.showToast({title:e.message,icon:"none"}),200==e.code&&i.init()}))):n.cancel&&console.log("用户点击取消")}})},moreBtn:function(e,i){var s=this;t.showActionSheet({itemList:this.myId==i?["我要删除"]:["我要举报"],itemColor:this.myId==i?"#ff0000":"#000000",success:function(t){s.myId==i?s.delPost(e):s.showModal=!0},fail:function(t){}})},showPop:function(e,i){var s=this,n=[];e.forEach((function(t){n.push(s.imgBaseUrl+t.path)})),t.previewImage({current:i,urls:n})},toClub:function(e){t.navigateTo({url:"/pages/community/club/club?id="+e})},toMinePage:function(e){t.navigateTo({url:"/pages/community/minePage/minePage?id="+e})},toDetail:function(e){t.navigateTo({url:"/pages/community/commDetail/commDetail?id="+e})},like:function(e,i){var n=this;(0,s.praisePosts)({id:e}).then((function(e){n.dataList[i].is_praise=!n.dataList[i].is_praise,200==e.code?(n.dataList[i].praise_num++,t.showToast({title:e.message,icon:"none",duration:1500})):1==e.code?n.dataList[i].praise_num--:t.showToast({title:e.message,icon:"none",duration:1500})}))},clearSearch:function(e){"all"==e?(this.searList=[],t.setStorage({key:"searchHistory",data:this.searList,success:function(){}})):(this.searList.splice(e,1),t.setStorage({key:"searchHistory",data:this.searList,success:function(){}}))}},onLoad:function(e){var i=this;t.getStorage({key:"searchHistory",success:function(t){i.searList=t.data}})}};e.default=n}).call(this,i("543d")["default"])},"1d83":function(t,e,i){},"5e7a":function(t,e,i){"use strict";(function(t){i("394a");s(i("66fd"));var e=s(i("8031"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},8031:function(t,e,i){"use strict";i.r(e);var s=i("8450"),n=i("999e");for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("ca8b");var o,u=i("f0c5"),c=Object(u["a"])(n["default"],s["b"],s["c"],!1,null,"4ea3123f",null,!1,s["a"],o);e["default"]=c.exports},8450:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return s}));var s={uIcon:function(){return i.e("node-modules/uview-ui/components/u-icon/u-icon").then(i.bind(null,"21b6"))},uSearch:function(){return i.e("node-modules/uview-ui/components/u-search/u-search").then(i.bind(null,"69f2"))},uReadMore:function(){return i.e("node-modules/uview-ui/components/u-read-more/u-read-more").then(i.bind(null,"4de6"))},uLoadmore:function(){return i.e("node-modules/uview-ui/components/u-loadmore/u-loadmore").then(i.bind(null,"811d"))}},n=function(){var t=this,e=t.$createElement,i=(t._self._c,0==t.active?t.__map(t.dataList,(function(e,i){var s=t.__get_orig(e),n=t.$u.timeFrom(e.create_time,!1);return{$orig:s,g0:n}})):null);t.$mp.data=Object.assign({},{$root:{l0:i}})},a=[]},"999e":function(t,e,i){"use strict";i.r(e);var s=i("1c6b"),n=i.n(s);for(var a in s)"default"!==a&&function(t){i.d(e,t,(function(){return s[t]}))}(a);e["default"]=n.a},ca8b:function(t,e,i){"use strict";var s=i("1d83"),n=i.n(s);n.a}},[["5e7a","common/runtime","common/vendor"]]]);