(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/community/addComm/addComm"],{"73c7":function(e,t,n){},accf:function(e,t,n){"use strict";var o=n("73c7"),i=n.n(o);i.a},b54c:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n("a34a")),i=n("8b93");function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,o,i,u,s){try{var c=e[u](s),a=c.value}catch(r){return void n(r)}c.done?t(a):Promise.resolve(a).then(o,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var u=e.apply(t,n);function c(e){s(u,o,i,c,a,"next",e)}function a(e){s(u,o,i,c,a,"throw",e)}c(void 0)}))}}var a=function(){n.e("components/helang-compress/helang-compress").then(function(){return resolve(n("d5f6"))}.bind(null,n)).catch(n.oe)},r={components:{helangCompress:a},data:function(){return{imgBaseUrl:getApp().globalData.imgBaseUrl,action:getApp().globalData.imgBaseUrl+"/common/upload/image.html",show:!1,selType:"",showShare:!1,typeValue:"公开",clubValue:"",fileList:[],form:{content:"",img:[],posts_auth:0,community_classify_id:null},typeList:[],communityList:[{id:0,class_name:"公开"},{id:1,class_name:"本校"}],list:[],type:1,end_id:null,club_id:""}},onShareAppMessage:function(t){var n=this;return"button"===t.from&&(0,i.sharePosts)({id:this.end_id}).then((function(t){200==t.code&&(e.showToast({title:t.message,duration:1500}),n.closeItem())})),{title:"动态发布",path:"/pages/community/commDetail/commDetail?id="+this.end_id,imageUrl:"/static/dongtai/share_dt.png"}},onShareTimeline:function(e){return"button"===e.from&&console.log(2,e.target),{title:"自定义转发标题",path:"/pages/community/commDetail/commDetail?id="+this.end_id}},onLoad:function(t){var n=this;this.type=t.type,1!=t.type&&(this.club_id=t.club_id),e.showLoading({title:"加载中...",mask:!0}),(0,i.getCommunityClassify)({}).then((function(t){e.hideLoading(),200==t.code&&(n.typeList=t.result,n.form.community_classify_id=t.result[0].id,n.clubValue=t.result[0].class_name)}))},methods:{beforeUpload:function(t,n){var i=this;return c(o.default.mark((function u(){return o.default.wrap((function(u){while(1)switch(u.prev=u.next){case 0:return e.showLoading({title:"检测中...",mask:!0}),u.prev=1,u.next=4,i.$refs.helangCompress.compress({src:n[t].url}).then(function(){var e=c(o.default.mark((function e(u){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$check.checkImg1(t,u,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:u.next=9;break;case 6:u.prev=6,u.t0=u["catch"](1),console.log("e",u.t0);case 9:case"end":return u.stop()}}),u,null,[[1,6]])})))()},onRemove:function(e,t){(0,i.delImages)(this.form.img[e]).then((function(e){})),this.form.img.splice(e,1)},onSuccess:function(t,n,o,i){200==t.code?this.form.img.push({path:t.result.src}):e.showToast({title:"上传失败",icon:"none"})},getType:function(e){this.selType=e,this.show=!this.show,this.list=1==e?this.communityList:this.typeList},confirm:function(e){1==this.selType?(this.typeValue=e[0].label,this.form.posts_auth=e[0].value):(this.clubValue=e[0].label,this.form.community_classify_id=e[0].value)},submit:function(){var t=this,n={};1!=this.type?(n.content=this.form.content,n.img=this.form.img,n.community_club_id=this.club_id):n=this.form,(0,i.posts)({data:n}).then((function(n){e.hideLoading(),200==n.code?(t.end_id=n.result.id,t.showShare=!t.showShare):0==n.code?(e.showToast({title:n.message,icon:"none"}),setTimeout((function(){e.navigateBack()}),1500)):e.showToast({title:n.message,icon:"none"})}))},addComm:function(){var t=this;if(e.showLoading({title:"提交中...",mask:!0}),""==this.form.content)return e.hideLoading(),e.showToast({title:"请输入想要发布的内容!",icon:"none"}),!1;e.requestSubscribeMessage({tmplIds:["mc5xJywLUfHxkLOaV2oIzYBbO3O0AqjTxq75RRAh_ps","CgI2RUfrhhaM0eKIykkjG80cxBGaw7gqwg7ulv8qBOs"],complete:function(){var e=c(o.default.mark((function e(n){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$check.checkTxt(t.form.content);case 3:t.submit(),e.next=10;break;case 6:return e.prev=6,e.t0=e["catch"](0),t.form.content="",e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));function n(t){return e.apply(this,arguments)}return n}()})},closeItem:function(){1!=this.type?e.redirectTo({url:"/pages/community/club/club?id="+this.club_id}):e.switchTab({url:"/pages/Tab/tabComm/community"}),this.showShare=!this.showShare}}};t.default=r}).call(this,n("543d")["default"])},b657:function(e,t,n){"use strict";n.r(t);var o=n("b54c"),i=n.n(o);for(var u in o)"default"!==u&&function(e){n.d(t,e,(function(){return o[e]}))}(u);t["default"]=i.a},c5c0:function(e,t,n){"use strict";n.r(t);var o=n("ffc5"),i=n("b657");for(var u in i)"default"!==u&&function(e){n.d(t,e,(function(){return i[e]}))}(u);n("accf");var s,c=n("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"6cca0a48",null,!1,o["a"],s);t["default"]=a.exports},f0de:function(e,t,n){"use strict";(function(e){n("394a");o(n("66fd"));var t=o(n("c5c0"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},ffc5:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return o}));var o={uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"f218"))},uCellItem:function(){return n.e("node-modules/uview-ui/components/u-cell-item/u-cell-item").then(n.bind(null,"92f3"))},uSelect:function(){return n.e("node-modules/uview-ui/components/u-select/u-select").then(n.bind(null,"cde0"))},uPopup:function(){return n.e("node-modules/uview-ui/components/u-popup/u-popup").then(n.bind(null,"d202"))},uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"21b6"))},helangCompress:function(){return n.e("components/helang-compress/helang-compress").then(n.bind(null,"d5f6"))}},i=function(){var e=this,t=e.$createElement;e._self._c},u=[]}},[["f0de","common/runtime","common/vendor"]]]);