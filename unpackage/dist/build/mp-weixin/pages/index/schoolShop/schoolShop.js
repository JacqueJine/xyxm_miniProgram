(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/schoolShop/schoolShop"],{"078d":function(t,e,i){"use strict";(function(t){i("394a");n(i("66fd"));var e=n(i("79de"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},"16bd":function(t,e,i){"use strict";var n=i("73cf"),s=i.n(n);s.a},"73cf":function(t,e,i){},"79de":function(t,e,i){"use strict";i.r(e);var n=i("fd71"),s=i("92eb");for(var o in s)"default"!==o&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("16bd");var r,a=i("f0c5"),c=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,"1330b693",null,!1,n["a"],r);e["default"]=c.exports},"92eb":function(t,e,i){"use strict";i.r(e);var n=i("e85c"),s=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=s.a},e85c:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("3a43"),s={data:function(){return{tab:["商品","店铺详情"],act:0,list:[],act1:0,num:0,goods:[],class_id:0,showCar:!1,navTop:getApp().globalData.navTop,windowHeight:getApp().globalData.windowHeight,navHeight:getApp().globalData.navHeight,page:1,shop:"",shop_id:1,timeRange:"",imgBaseUrl:getApp().globalData.imgBaseUrl,carList:[],allprice:0}},onShareAppMessage:function(t){if("button"===t.from)return{title:this.shop.name,path:"/pages/index/schoolShop/schoolShop?store_id="+this.shop_id}},methods:{toCollect:function(){var e=this;(0,n.UserStoreCollect)({store_id:this.shop.id,status:0==this.shop.is_user_store_collect?1:0}).then((function(i){t.showToast({title:i.message,icon:"none"}),200==i.code&&e.getStore()}))},back:function(){t.navigateBack()},time_range:function(t,e){var i=t.split(":");if(2!=i.length)return!1;var n=e.split(":");if(2!=n.length)return!1;var s=new Date,o=new Date,r=new Date;return s.setHours(i[0]),s.setMinutes(i[1]),o.setHours(n[0]),o.setMinutes(n[1]),r.getTime()-s.getTime()>0&&r.getTime()-o.getTime()<0},toDetail:function(e){t.navigateTo({url:"/pages/index/schoolShop/goodsDetail/goodsDetail?id="+e+"&shop_id="+this.shop_id})},toOrder:function(){return 1==this.shop.state&&(this.time_range(this.shop.start_time,this.shop.end_time)?this.allprice<this.shop.upsendmoney?(t.showToast({title:"未满起送金额",icon:"none"}),!1):this.carList.length<=0?(t.showToast({title:"请选择商品",icon:"none"}),!1):void t.navigateTo({url:"/pages/index/schoolShop/goodsOrder/goodsOrder?shop_id="+this.shop_id}):(t.showToast({title:"该店铺已不营业",icon:"none"}),!1))},getgoods:function(){var t=this,e={};e=0==this.act1?{where:{store_id:this.shop_id,shelves:1},page:this.page,limit:1e4}:{where:{store_id:this.shop_id,class_id:this.class_id,shelves:1},page:this.page,limit:10},(0,n.getGood)(e).then((function(e){200==e.code&&(t.goods=t.goods.concat(e.result.data))}))},changeitem:function(t){this.act=t},changeitem1:function(t,e){this.act1=t,this.page=1,this.goods=[],0!=t&&(this.class_id=e),this.getgoods()},add:function(e){var i=this,n=this,s=t.getStorageSync("car")||[],o=s.find((function(t){return t.shop_id===i.shop_id}));if(o){if(0==e.num)return!1;var r=o.cartItems.find((function(t){return t.id===e.id}));if(r){if(e.num<=r.carnum)return!1;r.carnum++}else e.carnum=1,o.cartItems.push(e)}else e.carnum=1,s.push({shop_id:this.shop_id,cartItems:[e]});t.setStorage({key:"car",data:s,success:function(e){for(var i in n.carList=t.getStorageSync("car").find((function(t){return t.shop_id===n.shop_id})).cartItems,n.allprice=0,n.carList)n.allprice=n.allprice+n.carList[i].carnum*Number(n.carList[i].price)}})},jian:function(e){var i=this,n=this,s=t.getStorageSync("car")||[],o=s.find((function(t){return t.shop_id===i.shop_id}));o.cartItems.find((function(t,n,s){return t.id===e.id&&(1==t.carnum?(s.splice(n,1),s.length<1&&(i.showCar=!1)):t.carnum--),t.id===e.id}));t.setStorage({key:"car",data:s,success:function(e){for(var i in n.carList=t.getStorageSync("car").find((function(t){return t.shop_id===n.shop_id})).cartItems,n.allprice=0,n.carList)n.allprice=n.allprice+n.carList[i].carnum*Number(n.carList[i].price)}})},delcar:function(){var e=this,i=this,n=t.getStorageSync("car")||[],s=n.find((function(t){return t.shop_id===e.shop_id}));s.cartItems=[],this.showCar=!1,t.setStorage({key:"car",data:n,success:function(e){i.carList=t.getStorageSync("car").find((function(t){return t.shop_id===i.shop_id})).cartItems,i.allprice=0}})},getCar:function(){if(this.carList.length<1)return!1;this.showCar=!this.showCarl},getStore:function(){var t=this;(0,n.storeDetail)({id:this.shop_id}).then((function(e){200==e.code&&(t.shop=e.result,t.timeRange=t.time_range(t.shop.start_time,t.shop.end_time))}))}},onReachBottom:function(){},onLoad:function(e){var i=this;this.shop_id=e.store_id,t.removeStorageSync("issueInfo"),t.removeStorageSync("address_id"),(0,n.getClass)({id:e.store_id}).then((function(t){(t.code=200)&&(i.list=t.result)})),this.getgoods(),this.getStore()},onShow:function(){var e=this,i=t.getStorageSync("car")||[],n=i.find((function(t){return t.shop_id===e.shop_id}));if(n)if(this.carList=n.cartItems,this.carList.length>0)for(var s in this.allprice=0,this.carList)this.allprice=this.allprice+this.carList[s].carnum*Number(this.carList[s].price);else this.allprice=0;else this.carList=[]}};e.default=s}).call(this,i("543d")["default"])},fd71:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var n={uIcon:function(){return i.e("node-modules/uview-ui/components/u-icon/u-icon").then(i.bind(null,"21b6"))},uPopup:function(){return i.e("node-modules/uview-ui/components/u-popup/u-popup").then(i.bind(null,"d202"))}},s=function(){var t=this,e=t.$createElement;t._self._c},o=[]}},[["078d","common/runtime","common/vendor"]]]);