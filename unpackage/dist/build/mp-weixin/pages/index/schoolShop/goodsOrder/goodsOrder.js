(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/schoolShop/goodsOrder/goodsOrder"],{"2e52":function(s,e,t){"use strict";(function(s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=t("3a43"),r=t("d160"),n=(t("6c29"),{data:function(){return{imgBaseUrl:getApp().globalData.imgBaseUrl,showPay:!1,payType:0,goodsid:"",curSelectAddress:"",remark:"",wallets_password:"",showPI:!1,focus:!1,shop:{},carList:[],shop_id:"",allprice:0,base_send:0,yue:0}},methods:{setFocus:function(){this.focus=!1,this.wallets_password=""},changepayType:function(s){this.payType=s},changeAdd:function(e){1==e?s.navigateTo({url:"/pages/mine/mineSetting/address/address"}):s.navigateTo({url:"/pages/index/schoolShop/goodsOrder/remark/remark?frompage=goodsorder&remark="+this.remark})},toPay:function(){if(0==JSON.parse(s.getStorageSync("user")).is_pay_pwd)s.navigateTo({url:"/pages/mine/mineSetting/setPass/setPass"});else if(0==this.payType){if(this.yue<this.price)return s.showToast({title:"余额不足",icon:"none"}),!1;this.showPay=!this.showPay,this.showPI=!this.showPI}},toforget:function(){s.navigateTo({url:"/pages/mine/mineSetting/setPass/findPass/findPass?type=2"})},set_wallets_password:function(){var e=this;if(6==this.wallets_password.length){this.focus=!1,s.showLoading({title:"支付中……",mask:!0});var t=[];for(var r in this.carList)t.push({goods_id:this.carList[r].id,goods_num:this.carList[r].carnum,goods_price:this.carList[r].price});(0,i.addOrderAll)({data:{store_id:this.shop_id,address_id:this.curSelectAddress.id,order_freight:this.base_send,pay_total:this.allprice,note:this.remark,desc:t,pay_pwd:this.wallets_password}}).then((function(t){s.hideLoading(),s.showToast({title:t.message,icon:"none"}),e.showPI=!1,e.wallets_password="",200==t.code&&(e.delcar(),setTimeout((function(){s.redirectTo({url:"/pages/mine/shop/myshopOrder/myorderDetail/myorderDetail?id="+t.result.order_id})}),1500))}))}},delcar:function(){var e=this,t=s.getStorageSync("car")||[],i=t.find((function(s){return s.shop_id===e.shop_id}));i.cartItems=[],s.setStorage({key:"car",data:t,success:function(s){}})},getPrice:function(){if(0==this.shop.send_status)for(var s in this.carList)this.allprice=this.allprice+this.carList[s].carnum*Number(this.carList[s].price);else if(1==this.shop.send_status){for(var e in this.base_send=this.shop.base_send,this.carList)this.allprice=this.allprice+this.carList[e].carnum*Number(this.carList[e].price);this.allprice=this.allprice+this.base_send}else if(2==this.shop.send_status){for(var t in this.carList)this.allprice=this.allprice+this.carList[t].carnum*Number(this.carList[t].price);this.allprice>=this.shop.discount?this.base_send=this.shop.send_fee:this.base_send=this.shop.base_send,this.allprice=this.allprice+this.base_send}},getress:function(s){var e=this;(0,r.getAddress)().then((function(t){200==t.code&&(s?(e.curSelectAddress=t.result.find((function(e){return e.id===s})),console.log(e.curSelectAddress)):(e.curSelectAddress=t.result.find((function(s){return 1===s.is_default})),console.log(e.curSelectAddress)))}))}},onLoad:function(e){var t=this;this.shop_id=Number(e.shop_id),(0,i.storeDetail)({id:this.shop_id}).then((function(e){200==e.code&&(t.shop=e.result,t.carList=s.getStorageSync("car").find((function(s){return s.shop_id===t.shop_id})).cartItems,t.getPrice())})),this.getress(),(0,r.findUserInfo)({}).then((function(s){200==s.code&&(t.yue=s.result.wallet)}))},onShow:function(){var e=this;s.getStorage({key:"issueInfo",success:function(s){var t=JSON.parse(s.data);e.remark=t.value,e.goodsid=t.goodsid}});var t="";t=s.getStorageSync("address_id"),t&&this.getress(t)}});e.default=n}).call(this,t("543d")["default"])},"30ac":function(s,e,t){"use strict";t.r(e);var i=t("2e52"),r=t.n(i);for(var n in i)"default"!==n&&function(s){t.d(e,s,(function(){return i[s]}))}(n);e["default"]=r.a},"37af":function(s,e,t){"use strict";t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return n})),t.d(e,"a",(function(){return i}));var i={uIcon:function(){return t.e("node-modules/uview-ui/components/u-icon/u-icon").then(t.bind(null,"21b6"))},uPopup:function(){return t.e("node-modules/uview-ui/components/u-popup/u-popup").then(t.bind(null,"d202"))}},r=function(){var s=this,e=s.$createElement;s._self._c;s._isMounted||(s.e0=function(e){s.showPay=!s.showPay},s.e1=function(e){s.focus=!0})},n=[]},5951:function(s,e,t){},7856:function(s,e,t){"use strict";var i=t("5951"),r=t.n(i);r.a},bbb5:function(s,e,t){"use strict";(function(s){t("394a");i(t("66fd"));var e=i(t("f59b"));function i(s){return s&&s.__esModule?s:{default:s}}s(e.default)}).call(this,t("543d")["createPage"])},f59b:function(s,e,t){"use strict";t.r(e);var i=t("37af"),r=t("30ac");for(var n in r)"default"!==n&&function(s){t.d(e,s,(function(){return r[s]}))}(n);t("7856");var o,a=t("f0c5"),c=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,"37a7ebab",null,!1,i["a"],o);e["default"]=c.exports}},[["bbb5","common/runtime","common/vendor"]]]);