(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/addIssue/expressageIssue/expressageIssue"],{"0ef6":function(e,t,s){"use strict";s.r(t);var n=s("bb5d"),i=s("b4bf");for(var o in i)"default"!==o&&function(e){s.d(t,e,(function(){return i[e]}))}(o);s("f5bb");var r,u=s("f0c5"),a=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"acbc7af0",null,!1,n["a"],r);t["default"]=a.exports},7601:function(e,t,s){"use strict";(function(e){s("394a");n(s("66fd"));var t=n(s("0ef6"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("543d")["createPage"])},b4bf:function(e,t,s){"use strict";s.r(t);var n=s("b623"),i=s.n(n);for(var o in n)"default"!==o&&function(e){s.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},b623:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("a34a")),i=s("6c29"),o=s("d160");function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t,s,n,i,o,r){try{var u=e[o](r),a=u.value}catch(h){return void s(h)}u.done?t(a):Promise.resolve(a).then(n,i)}function a(e){return function(){var t=this,s=arguments;return new Promise((function(n,i){var o=e.apply(t,s);function r(e){u(o,n,i,r,a,"next",e)}function a(e){u(o,n,i,r,a,"throw",e)}r(void 0)}))}}var h={data:function(){return{showinput:!1,textFocus:!1,comment:"",index:1,textindex:0,expressageInfo:[{task_address:"",destination:"",express_desc:""}],time:"",destination_time:"",showTime:!1,list:[],issuerInfo:{name:"",tel:"",notes:""},money:"",is_urgent:0,urgent_price:"0",price:"",j_rate:"",regMoney:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^[1-9]$)|(^\d\.[1-9]{1,2}$)|(^\d\.[0]{1}[1-9]{1}$|(^\d\.[1-9]{1}[0]{1}$)$)/,regPhone:/^((13[0-9])|(17[0-1,6-8])|(15[^4,\\D])|(18[0-9]))\d{8}$/}},methods:{getindex1:function(e,t){5==e?this.comment=this.expressageInfo[t].task_address:6==e?this.comment=this.expressageInfo[t].destination:8==e&&(this.comment=this.expressageInfo[t].express_desc),this.showinput=!this.showinput,this.textindex=t,this.index=e},getindex:function(e){1==e?this.comment=this.issuerInfo.name:2==e?this.comment=this.issuerInfo.tel:3==e?this.comment=this.money:4==e?this.comment=this.urgent_price:7==e&&(this.comment=this.issuerInfo.notes),this.showinput=!this.showinput,this.index=e},addComm:function(){if(""==this.comment)return e.showToast({title:"请输入内容",icon:"none"}),!1;if(1==this.index){if(this.comment.length>8)return e.showToast({title:"昵称不能超过8个字",icon:"none"}),!1;this.issuerInfo.name=this.comment}else if(2==this.index){if(!this.regPhone.test(this.comment))return e.showToast({title:"请输入正确手机号",icon:"none"}),!1;this.issuerInfo.tel=this.comment}else if(3==this.index){if(!this.regMoney.test(this.comment))return e.showToast({title:"请输入正确赏金",icon:"none"}),!1;this.money=this.comment}else if(4==this.index){if(!this.regMoney.test(this.comment))return e.showToast({title:"请输入正确加急金额",icon:"none"}),!1;this.urgent_price=this.comment}if(5==this.index){if(this.comment.length>16)return e.showToast({title:"取件地点不能超过16个字",icon:"none"}),!1;this.expressageInfo[this.textindex].task_address=this.comment}else if(6==this.index){if(this.comment.length>16)return e.showToast({title:"送件地点不能超过16个字",icon:"none"}),!1;this.expressageInfo[this.textindex].destination=this.comment}else if(8==this.index){if(this.comment.length>30)return e.showToast({title:"取件信息不能超过30个字",icon:"none"}),!1;this.expressageInfo[this.textindex].express_desc=this.comment}else if(7==this.index){if(this.comment.length>30)return e.showToast({title:"备注不能超过30个字",icon:"none"}),!1;this.issuerInfo.notes=this.comment}this.showinput=!this.showinput},getTime:function(){this.setTime(),this.showTime=!this.showTime},confirm:function(e){var t=new Date;this.time=e[0].label+" "+e[1].label+":"+e[2].label+"前",this.destination_time=t.getFullYear()+"/"+Number(t.getMonth()+1)+"/"+t.getDate()+" "+e[1].label+":"+e[2].label+":00"},setTime:function(){this.list=[];for(var e=new Date,t=e.getMinutes(),s=e.getHours()+1,n=0;n<2;n++)if(this.list.push({value:"",label:0==n?"今天 "+Number(e.getMonth()+1)+"/"+e.getDate():"明天"+Number(e.getMonth()+1)+"/"+Number(e.getDate()+1),children:[]}),0==n){if(24==s)return!1;for(var i=s;i<24;i++)i<10?this.list[0].children.push({value:"",label:"0"+i,children:[]}):this.list[0].children.push({value:"",label:i,children:[]})}else for(var o=0;o<24;o++)o<10?this.list[1].children.push({value:"",label:"0"+o,children:[]}):this.list[1].children.push({value:"",label:o,children:[]});for(var r=0;r<this.list[1].children.length;r++)for(var u=0;u<60;u+=30)this.list[1].children[r].children.push({value:"",label:0==u?"00":u});for(var a=0;a<this.list[0].children.length;a++)if(t<30)for(var h=t;h<60;h+=30)this.list[0].children[a].children.push({value:"",label:h<10?"0"+h:h});else if(t>=30)for(var c=t;c>=0;c-=30)this.list[0].children[a].children.push({value:"",label:c<10?"0"+c:c});t>=30&&this.list[0].children[0].children.splice(1,1)},urgentPrice:function(){e.showModal({title:"赏金说明",content:"加急赏金是给接单者的加急奖励，平台收取 "+this.j_rate+"% 手续费，且加急金额不能小于2元",confirmText:"我已了解",confirmColor:"rgba(255, 221, 5, 1)",showCancel:!1,success:function(e){e.confirm}})},jian:function(){this.expressageInfo.splice(-1,1)},add:function(){this.expressageInfo=this.expressageInfo.concat({task_address:"",destination:"",express_desc:""})},getKey:function(){var e=this;(0,i.getInfoSystem)({key:"加急费率"}).then((function(t){200==t.code&&(e.j_rate=t.result.value)}))},issue:function(){var t=this;for(var s in this.expressageInfo){if(""==this.expressageInfo[s].task_address)return e.showToast({title:"请输入取件地点",icon:"none"}),!1;if(""==this.expressageInfo[s].destination)return e.showToast({title:"请输入送件地点",icon:"none"}),!1;if(""==this.expressageInfo[s].express_desc)return e.showToast({title:"请输入取件信息",icon:"none"}),!1}if(""==this.destination_time)return e.showToast({title:"请选择送件时间",icon:"none"}),!1;if(""==this.issuerInfo.name)return e.showToast({title:"请输入您的称呼",icon:"none"}),!1;if(!this.regPhone.test(this.issuerInfo.tel))return e.showToast({title:"请输入正确手机号",icon:"none"}),!1;if(!this.regMoney.test(this.money))return e.showToast({title:"请输入正确赏金",icon:"none"}),!1;if(1==this.is_urgent&&(!this.regMoney.test(this.urgent_price)||this.urgent_price<2))return e.showToast({title:"请输入正确加急金额",icon:"none"}),!1;this.price=this.$Numcheck.rounding(1*this.money+1*this.urgent_price,2);var o={type:1,desc:this.expressageInfo,title:"取快递"+this.expressageInfo.length+"件",destination_time:this.destination_time,user_name:this.issuerInfo.name,user_phone:this.issuerInfo.tel,comment:this.issuerInfo.notes,money:this.money,is_urgent:this.is_urgent,is_good_prepay:0,good_prepay:0,user_id:JSON.parse(e.getStorageSync("user")).id,urgent_price:this.urgent_price,price:this.price},r="";for(var u in this.expressageInfo)r=r+this.expressageInfo[u].task_address+this.expressageInfo[u].destination+this.expressageInfo[u].express_desc;r=r+this.issuerInfo.name+this.issuerInfo.notes,e.requestSubscribeMessage({tmplIds:["Q0dB1QJc9GcGSfT5tpj6GBbf53JiHhz6RDQZOVM6i3Y","mc5xJywLUfHxkLOaV2oIzYBbO3O0AqjTxq75RRAh_ps","VkSklDJC5xONLGxOfWoJS1uWdVzBztd--rZasHzsMMI"],complete:function(){var s=a(n.default.mark((function s(u){var a;return n.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.$check.checkTxt(r);case 3:e.showLoading({title:"提交中……",mask:!0}),(0,i.addTask)({data:o}).then((function(t){200==t.code?setTimeout((function(){e.hideLoading(),e.redirectTo({url:"/pages/addIssue/issueOrder/issueOrder?id="+t.result.task_id})}),1500):(e.hideLoading(),e.showToast({title:t.message,icon:"none"}))})),s.next=15;break;case 7:for(a in s.prev=7,s.t0=s["catch"](0),t.expressageInfo)t.expressageInfo[a].task_address="",t.expressageInfo[a].destination="",t.expressageInfo[a].express_desc="";return t.time="",t.destination_time="",t.issuerInfo.name="",t.issuerInfo.notes="",s.abrupt("return",!1);case 15:case"end":return s.stop()}}),s,null,[[0,7]])})));function u(e){return s.apply(this,arguments)}return u}()})}},onLoad:function(e){var t=this;e.id?(0,i.getInfoTask)({id:e.id}).then((function(e){if(200==e.code){for(var s in t.issuerInfo.name=e.result.user_name,t.issuerInfo.tel=e.result.user_phone,t.issuerInfo.notes=e.result.comment,t.money=e.result.money,t.is_urgent=e.result.is_urgent,t.urgent_price=e.result.urgent_price,t.expressageInfo=[],e.result.task_expressage)t.expressageInfo.push({task_address:e.result.task_expressage[s].task_address,destination:e.result.task_expressage[s].destination,express_desc:e.result.task_expressage[s].express_desc});t.getKey()}})):(0,o.findUserInfo)({}).then((function(e){200==e.code&&(t.issuerInfo.name=e.result.name,t.issuerInfo.tel=e.result.phone,t.getKey())}))},onShow:function(){}};t.default=h}).call(this,s("543d")["default"])},bb5d:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return n}));var n={uIcon:function(){return s.e("node-modules/uview-ui/components/u-icon/u-icon").then(s.bind(null,"21b6"))},uSwitch:function(){return s.e("node-modules/uview-ui/components/u-switch/u-switch").then(s.bind(null,"f3be"))},uSelect:function(){return s.e("node-modules/uview-ui/components/u-select/u-select").then(s.bind(null,"cde0"))},uPopup:function(){return s.e("node-modules/uview-ui/components/u-popup/u-popup").then(s.bind(null,"d202"))}},i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.textFocus=!0},e.e1=function(t){e.textFocus=!1})},o=[]},db37:function(e,t,s){},f5bb:function(e,t,s){"use strict";var n=s("db37"),i=s.n(n);i.a}},[["7601","common/runtime","common/vendor"]]]);