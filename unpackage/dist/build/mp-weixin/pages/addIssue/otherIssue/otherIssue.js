(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/addIssue/otherIssue/otherIssue"],{"0650":function(e,t,s){"use strict";var n=s("2e84"),i=s.n(n);i.a},"141d":function(e,t,s){"use strict";s.r(t);var n=s("9534"),i=s("6bf0");for(var o in i)"default"!==o&&function(e){s.d(t,e,(function(){return i[e]}))}(o);s("0650");var r,u=s("f0c5"),a=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"546562c0",null,!1,n["a"],r);t["default"]=a.exports},"1a6b":function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("a34a")),i=s("6c29"),o=s("d160");function r(e){return e&&e.__esModule?e:{default:e}}function u(e,t,s,n,i,o,r){try{var u=e[o](r),a=u.value}catch(h){return void s(h)}u.done?t(a):Promise.resolve(a).then(n,i)}function a(e){return function(){var t=this,s=arguments;return new Promise((function(n,i){var o=e.apply(t,s);function r(e){u(o,n,i,r,a,"next",e)}function a(e){u(o,n,i,r,a,"throw",e)}r(void 0)}))}}var h={data:function(){return{showinput:!1,textFocus:!1,comment:"",index:1,issueType:"",issuerInfo:{name:"",tel:"",notes:""},taskInfo:{title:"",task_address:"",destination:"",express_desc:""},showTime:!1,list:[],time:"",destination_time:"",money:"",urgent_price:"0",is_urgent:0,is_good_prepay:0,good_prepay:"0",price:0,loading:!1,y_rate:0,j_rate:0,regMoney:/(^[1-9](\d+)?(\.\d{1,2})?$)|(^[1-9]$)|(^\d\.[1-9]{1,2}$)|(^\d\.[0]{1}[1-9]{1}$|(^\d\.[1-9]{1}[0]{1}$)$)/,regPhone:/^((13[0-9])|(17[0-1,6-8])|(15[^4,\\D])|(18[0-9]))\d{8}$/}},methods:{getindex:function(e){this.index=e,this.showinput=!this.showinput,1==e?this.comment=this.issuerInfo.name:2==e?this.comment=this.issuerInfo.tel:3==e?this.comment=this.money:4==e?this.comment=this.urgent_price:5==e?this.comment=this.good_prepay:6==e?this.comment=this.taskInfo.task_address:7==e?this.comment=this.taskInfo.destination:8==e?this.comment=this.taskInfo.title:9==e?this.comment=this.issuerInfo.notes:10==e&&(this.comment=this.taskInfo.express_desc)},addComm:function(){if(""==this.comment)return e.showToast({title:"请输入内容",icon:"none"}),!1;if(1==this.index){if(this.comment.length>8)return e.showToast({title:"昵称不能超过8个字",icon:"none"}),!1;this.issuerInfo.name=this.comment}else if(2==this.index){if(!this.regPhone.test(this.comment))return e.showToast({title:"请输入正确手机号",icon:"none"}),!1;this.issuerInfo.tel=this.comment}else if(3==this.index){if(!this.regMoney.test(this.comment))return e.showToast({title:"请输入正确赏金",icon:"none"}),!1;this.money=this.comment}else if(4==this.index){if(!this.regMoney.test(this.comment))return e.showToast({title:"请输入正确加急金额",icon:"none"}),!1;this.urgent_price=this.comment}else if(5==this.index){if(!this.regMoney.test(this.comment))return e.showToast({title:"请输入正确预付金额",icon:"none"}),!1;this.good_prepay=this.comment}if(6==this.index){if(this.comment.length>16)return e.showToast({title:"取件地点不能超过16个字",icon:"none"}),!1;this.taskInfo.task_address=this.comment}else if(7==this.index){if(this.comment.length>16)return e.showToast({title:"送件地点不能超过16个字",icon:"none"}),!1;this.taskInfo.destination=this.comment}else if(8==this.index){if(this.comment.length>12)return e.showToast({title:"标题不能超过12个字",icon:"none"}),!1;this.taskInfo.title=this.comment}else if(9==this.index){if(this.comment.length>30)return e.showToast({title:"备注不能超过30个字",icon:"none"}),!1;this.issuerInfo.notes=this.comment}else if(10==this.index){if(this.comment.length>30)return e.showToast({title:"任务内容不能超过30个字",icon:"none"}),!1;this.taskInfo.express_desc=this.comment}this.showinput=!this.showinput},getKey:function(){var e=this;(0,i.getInfoSystem)({key:"预付费率"}).then((function(t){200==t.code&&(e.y_rate=t.result.value)})),(0,i.getInfoSystem)({key:"加急费率"}).then((function(t){200==t.code&&(e.j_rate=t.result.value)}))},getTime:function(){this.setTime(),this.showTime=!this.showTime},confirm:function(e){var t=new Date;this.time=e[0].label+" "+e[1].label+":"+e[2].label+"前",this.destination_time=t.getFullYear()+"/"+Number(t.getMonth()+1)+"/"+t.getDate()+" "+e[1].label+":"+e[2].label+":00"},setTime:function(){this.list=[];for(var e=new Date,t=e.getMinutes(),s=e.getHours()+1,n=0;n<2;n++)if(this.list.push({value:"",label:0==n?"今天 "+Number(e.getMonth()+1)+"/"+e.getDate():"明天"+Number(e.getMonth()+1)+"/"+Number(e.getDate()+1),children:[]}),0==n){if(24==s)return!1;for(var i=s;i<24;i++)i<10?this.list[0].children.push({value:"",label:"0"+i,children:[]}):this.list[0].children.push({value:"",label:i,children:[]})}else for(var o=0;o<24;o++)o<10?this.list[1].children.push({value:"",label:"0"+o,children:[]}):this.list[1].children.push({value:"",label:o,children:[]});for(var r=0;r<this.list[1].children.length;r++)for(var u=0;u<60;u+=30)this.list[1].children[r].children.push({value:"",label:0==u?"00":u});for(var a=0;a<this.list[0].children.length;a++)if(t<30)for(var h=t;h<60;h+=30)this.list[0].children[a].children.push({value:"",label:h<10?"0"+h:h});else if(t>=30)for(var c=t;c>=0;c-=30)this.list[0].children[a].children.push({value:"",label:c<10?"0"+c:c});t>=30&&this.list[0].children[0].children.splice(1,1)},urgentWarn:function(t){1==t?e.showModal({title:"赏金说明",content:"加急赏金是给接单者的加急奖励，平台收取"+this.j_rate+"% 手续费,且加急金额不能小于2元",confirmText:"我已了解",confirmColor:"rgba(255, 221, 5, 1)",showCancel:!1,success:function(e){e.confirm?console.log("点击确认回调"):console.log("点击取消回调")}}):e.showModal({title:"预付说明",content:"如果输入预付金额，根据微信平台规则将收取全部"+this.y_rate+"%手续费，且预付金额不能为0",confirmText:"我已了解",confirmColor:"rgba(255, 221, 5, 1)",showCancel:!1,success:function(e){e.confirm?console.log("点击确认回调"):console.log("点击取消回调")}})},goTextarea:function(t,s){1==this.issueType?e.navigateTo({url:"/pages/index/schoolShop/goodsOrder/remark/remark?frompage=expressageIssue&remark="+this.issuerInfo.notes+"&type="+s}):e.navigateTo({url:"/pages/index/schoolShop/goodsOrder/remark/remark?frompage=expressageIssue&remark="+this.taskInfo.express_desc+"&type="+s})},issue:function(){var t=this,s="";if(1==this.issueType){if(""==this.taskInfo.title)return e.showToast({title:"请输入标题",icon:"none"}),!1;if(""==this.taskInfo.task_address)return e.showToast({title:"请输入取件地点",icon:"none"}),!1;if(""==this.taskInfo.destination)return e.showToast({title:"请输入送件地点",icon:"none"}),!1;if(""==this.destination_time)return e.showToast({title:"请选择送件时间",icon:"none"}),!1;if(""==this.issuerInfo.name)return e.showToast({title:"请输入您的称呼",icon:"none"}),!1;if(!this.regPhone.test(this.issuerInfo.tel))return e.showToast({title:"请输入正确手机号",icon:"none"}),!1;if(!this.regMoney.test(this.money))return e.showToast({title:"请输入正确赏金",icon:"none"}),!1;if(this.is_urgent&&(!this.regMoney.test(this.urgent_price)||this.urgent_price<2))return e.showToast({title:"请输入正确加急金额",icon:"none"}),!1;if(this.is_good_prepay){if(!this.regMoney.test(this.good_prepay)||this.good_prepay<=0)return e.showToast({title:"请输入正确预付金额",icon:"none"}),!1;var i=(1*this.money+1*this.urgent_price+1*this.good_prepay)*this.y_rate/100;i=this.$Numcheck.rounding(i,2),this.price=this.$Numcheck.rounding(1*this.money+1*this.urgent_price+1*this.good_prepay+1*i,2)}else this.price=this.$Numcheck.rounding(1*this.money+1*this.urgent_price,2);var o=this.taskInfo.title+this.issuerInfo.name+this.taskInfo.task_address+this.taskInfo.destination+this.issuerInfo.notes;s={type:2,title:this.taskInfo.title,user_name:this.issuerInfo.name,user_phone:this.issuerInfo.tel,money:this.money,task_address:this.taskInfo.task_address,destination:this.taskInfo.destination,destination_time:this.destination_time,is_urgent:this.is_urgent,is_good_prepay:this.is_good_prepay,good_prepay:this.good_prepay,comment:this.issuerInfo.notes,user_id:JSON.parse(e.getStorageSync("user")).id,urgent_price:this.urgent_price,price:this.price},e.requestSubscribeMessage({tmplIds:["Q0dB1QJc9GcGSfT5tpj6GBbf53JiHhz6RDQZOVM6i3Y","mc5xJywLUfHxkLOaV2oIzYBbO3O0AqjTxq75RRAh_ps","VkSklDJC5xONLGxOfWoJS1uWdVzBztd--rZasHzsMMI"],complete:function(){var e=a(n.default.mark((function e(i){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$check.checkTxt(o);case 3:t.createTask(s),e.next=15;break;case 6:return e.prev=6,e.t0=e["catch"](0),t.taskInfo.title="",t.issuerInfo.name="",t.taskInfo.task_address="",t.taskInfo.destination="",t.issuerInfo.notes="",t.destination_time="",e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,6]])})));function i(t){return e.apply(this,arguments)}return i}()})}else{if(""==this.taskInfo.title)return e.showToast({title:"请输入标题",icon:"none"}),!1;if(""==this.issuerInfo.name)return e.showToast({title:"请输入您的称呼",icon:"none"}),!1;if(!this.regPhone.test(this.issuerInfo.tel))return e.showToast({title:"请输入正确手机号",icon:"none"}),!1;if(""==this.taskInfo.express_desc)return e.showToast({title:"请输入任务内容",icon:"none"}),!1;if(!this.regMoney.test(this.money))return e.showToast({title:"请输入正确赏金",icon:"none"}),!1;if(this.is_urgent&&(!this.regMoney.test(this.urgent_price)||this.urgent_price<2))return e.showToast({title:"请输入正确加急金额",icon:"none"}),!1;this.price=this.$Numcheck.rounding(1*this.money+1*this.urgent_price,2),s={type:3,title:this.taskInfo.title,user_name:this.issuerInfo.name,user_phone:this.issuerInfo.tel,money:this.money,express_desc:this.taskInfo.express_desc,is_urgent:this.is_urgent,user_id:JSON.parse(e.getStorageSync("user")).id,is_good_prepay:0,good_prepay:0,urgent_price:this.urgent_price,price:this.price};var r=this.taskInfo.title+this.issuerInfo.name+this.taskInfo.express_desc;e.requestSubscribeMessage({tmplIds:["Q0dB1QJc9GcGSfT5tpj6GBbf53JiHhz6RDQZOVM6i3Y","mc5xJywLUfHxkLOaV2oIzYBbO3O0AqjTxq75RRAh_ps","VkSklDJC5xONLGxOfWoJS1uWdVzBztd--rZasHzsMMI"],complete:function(){var e=a(n.default.mark((function e(i){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$check.checkTxt(r);case 3:t.createTask(s),e.next=12;break;case 6:return e.prev=6,e.t0=e["catch"](0),t.taskInfo.title="",t.issuerInfo.name="",t.taskInfo.express_desc="",e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));function i(t){return e.apply(this,arguments)}return i}()})}},createTask:function(t){e.showLoading({title:"提交中……",mask:!0}),(0,i.addTask)({data:t}).then((function(t){200==t.code?setTimeout((function(){e.hideLoading(),e.redirectTo({url:"/pages/addIssue/issueOrder/issueOrder?id="+t.result.task_id})}),1500):(e.hideLoading(),e.showToast({title:t.message,icon:"none"}))}))}},onLoad:function(t){var s=this;this.issueType=t.issueType,1==t.issueType?e.setNavigationBarTitle({title:"跑腿发布"}):e.setNavigationBarTitle({title:"其他任务发布"}),t.id?(0,i.getInfoTask)({id:t.id}).then((function(e){200==e.code&&(s.issuerInfo.name=e.result.user_name,s.issuerInfo.tel=e.result.user_phone,s.issuerInfo.notes=e.result.comment,s.taskInfo.title=e.result.title,s.taskInfo.task_address=e.result.task_address,s.taskInfo.destination=e.result.destination,s.taskInfo.express_desc=e.result.express_desc,s.money=e.result.money,s.is_urgent=e.result.is_urgent,s.urgent_price=e.result.urgent_price,s.is_good_prepay=e.result.is_good_prepay,s.good_prepay=e.result.good_prepay,s.getKey())})):(0,o.findUserInfo)({}).then((function(e){200==e.code&&(s.issuerInfo.name=e.result.name,s.issuerInfo.tel=e.result.phone,s.getKey())}))},onShow:function(){}};t.default=h}).call(this,s("543d")["default"])},"2e84":function(e,t,s){},"6bf0":function(e,t,s){"use strict";s.r(t);var n=s("1a6b"),i=s.n(n);for(var o in n)"default"!==o&&function(e){s.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},"92c5":function(e,t,s){"use strict";(function(e){s("394a");n(s("66fd"));var t=n(s("141d"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,s("543d")["createPage"])},9534:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return n}));var n={uSwitch:function(){return s.e("node-modules/uview-ui/components/u-switch/u-switch").then(s.bind(null,"f3be"))},uIcon:function(){return s.e("node-modules/uview-ui/components/u-icon/u-icon").then(s.bind(null,"21b6"))},uSelect:function(){return s.e("node-modules/uview-ui/components/u-select/u-select").then(s.bind(null,"cde0"))},uPopup:function(){return s.e("node-modules/uview-ui/components/u-popup/u-popup").then(s.bind(null,"d202"))}},i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.textFocus=!0},e.e1=function(t){e.textFocus=!1})},o=[]}},[["92c5","common/runtime","common/vendor"]]]);