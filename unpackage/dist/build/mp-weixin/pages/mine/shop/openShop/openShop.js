(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/shop/openShop/openShop"],{"080d":function(e,n,t){},"11ac":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(t("a34a")),r=t("3a43"),a=t("8b93");function i(e){return e&&e.__esModule?e:{default:e}}function s(e,n,t,o,r,a,i){try{var s=e[a](i),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(o,r)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var a=e.apply(n,t);function i(e){s(a,o,r,i,c,"next",e)}function c(e){s(a,o,r,i,c,"throw",e)}i(void 0)}))}}var u=function(){t.e("components/helang-compress/helang-compress").then(function(){return resolve(t("d5f6"))}.bind(null,t)).catch(t.oe)},f={components:{helangCompress:u},data:function(){return{action:getApp().globalData.imgBaseUrl+"/common/upload/image.html",id:"",forminfo:{user_id:1,header:"",name:"",address:"",linkman:"",phone:"",image:[],backimage:""},fileList:[],fileList1:[],checked:!0,type:"",imgBaseUrl:getApp().globalData.imgBaseUrl,showxy:!1}},methods:{openShop:function(){var n=this;return c(o.default.mark((function t(){var a,i;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=/^((13[0-9])|(17[0-1,6-8])|(15[^4,\\D])|(18[0-9]))\d{8}$/,1==JSON.parse(e.getStorageSync("user")).is_real.code){t.next=6;break}return e.showToast({title:"实名后才能申请店铺",icon:"none"}),t.abrupt("return",!1);case 6:if(""!=n.forminfo.header){t.next=11;break}return e.showToast({title:"请上传店铺头像",icon:"none"}),t.abrupt("return",!1);case 11:if(""!=n.forminfo.name){t.next=16;break}return e.showToast({title:"请输入店铺名称",icon:"none"}),t.abrupt("return",!1);case 16:if(""!=n.forminfo.address){t.next=21;break}return e.showToast({title:"请输入店铺详细地址",icon:"none"}),t.abrupt("return",!1);case 21:if(""!=n.forminfo.linkman){t.next=26;break}return e.showToast({title:"请输入店铺联系人",icon:"none"}),t.abrupt("return",!1);case 26:if(a.test(n.forminfo.phone)){t.next=31;break}return e.showToast({title:"请输入正确手机号",icon:"none"}),t.abrupt("return",!1);case 31:if(!(n.forminfo.image.length<1)){t.next=36;break}return e.showToast({title:"请上传实体图",icon:"none"}),t.abrupt("return",!1);case 36:if(n.checked){t.next=39;break}return e.showToast({title:"请勾选店铺加盟协议",icon:"none"}),t.abrupt("return",!1);case 39:return t.prev=39,t.next=42,n.$check.checkTxt(n.forminfo.name+n.forminfo.linkman+n.forminfo.address);case 42:t.sent,t.next=51;break;case 45:return t.prev=45,t.t0=t["catch"](39),n.forminfo.address="",n.forminfo.name="",n.forminfo.linkman="",t.abrupt("return",!1);case 51:e.showLoading({title:"提交中……",mask:!0}),i={},0==n.type?i={data:n.forminfo}:3==n.type&&(i={id:n.id,data:n.forminfo}),(0,r.CreateStore)(i).then((function(n){e.hideLoading(),e.showToast({title:n.message,icon:"none"}),200==n.code&&setTimeout((function(){e.navigateBack()}),1500)}));case 55:case"end":return t.stop()}}),t,null,[[39,45]])})))()},uphead:function(){var n=this,t=this;e.showLoading({title:"检测中...",mask:!0}),e.chooseImage({sizeType:["compressed"],success:function(r){var a=r.tempFilePaths;n.$refs.helangCompress.compress({src:r.tempFilePaths[0]}).then(function(){var r=c(o.default.mark((function r(i){return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,n.$check.checkImg1(0,i,a);case 3:e.uploadFile({url:t.action,filePath:a[0],name:"file",header:{token:e.getStorageSync("token")},success:function(n){var o=JSON.parse(n.data);200==o.code?t.forminfo.header=o.result.src:e.showToast({title:o.message,icon:"none"})},complete:function(){e.hideLoading()}}),o.next=9;break;case 6:o.prev=6,o.t0=o["catch"](0),e.hideLoading();case 9:case"end":return o.stop()}}),r,null,[[0,6]])})));return function(e){return r.apply(this,arguments)}}()).catch((function(n){e.hideLoading(),e.showToast({title:"上传失败"}),console.log("eee",n)}))}})},beforeUpload:function(n,t){var r=this;return c(o.default.mark((function a(){return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.showLoading({title:"检测中...",mask:!0}),a.prev=1,a.next=4,r.$refs.helangCompress.compress({src:t[n].url}).then(function(){var e=c(o.default.mark((function e(a){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$check.checkImg1(n,a,t);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](1),console.log("e",a.t0);case 9:case"end":return a.stop()}}),a,null,[[1,6]])})))()},onSuccess:function(n,t,o,r){200==n.code?this.forminfo.image.push(n.result.src):e.showToast({title:n.message,icon:"none"})},onRemove:function(n,t){var o=this;(0,a.delImages)({path:this.forminfo.image[n]}).then((function(t){e.showToast({title:t.message,icon:"none"}),200==t.code&&o.forminfo.image.splice(n,1)}))},beforeUpload1:function(n,t){var r=this;return c(o.default.mark((function a(){return o.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.showLoading({title:"检测中...",mask:!0}),a.prev=1,a.next=4,r.$refs.helangCompress.compress({src:t[n].url}).then(function(){var e=c(o.default.mark((function e(a){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.$check.checkImg1(n,a,t);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:a.next=9;break;case 6:a.prev=6,a.t0=a["catch"](1),console.log("e",a.t0);case 9:case"end":return a.stop()}}),a,null,[[1,6]])})))()},onSuccess1:function(n,t,o,r){200==n.code?this.forminfo.backimage=n.result.src:e.showToast({title:n.message,icon:"none"})},onRemove1:function(n,t){var o=this;(0,a.delImages)({path:this.forminfo.backimage}).then((function(n){e.showToast({title:n.message,icon:"none"}),200==n.code&&(o.forminfo.backimage="")}))}},onLoad:function(n){var t=this;this.forminfo.user_id=JSON.parse(e.getStorageSync("user")).id,this.type=n.type,3==n.type&&(e.setNavigationBarTitle({title:"店铺信息设置"}),this.id=n.shopId,(0,r.storeDetail)({id:n.shopId}).then((function(e){if(200==e.code){for(var n in t.forminfo)t.forminfo[n]=e.result[n];for(var o in e.result.image)t.fileList.push({url:getApp().globalData.imgBaseUrl+e.result.image[o]});""!=e.result.backimage&&t.fileList1.push({url:getApp().globalData.imgBaseUrl+e.result.backimage})}})))}};n.default=f}).call(this,t("543d")["default"])},"13fe":function(e,n,t){"use strict";t.r(n);var o=t("fad9"),r=t("6dfd");for(var a in r)"default"!==a&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t("a84d");var i,s=t("f0c5"),c=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,"8f0c7c44",null,!1,o["a"],i);n["default"]=c.exports},6449:function(e,n,t){"use strict";(function(e){t("394a");o(t("66fd"));var n=o(t("13fe"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},"6dfd":function(e,n,t){"use strict";t.r(n);var o=t("11ac"),r=t.n(o);for(var a in o)"default"!==a&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a},a84d:function(e,n,t){"use strict";var o=t("080d"),r=t.n(o);r.a},fad9:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o}));var o={uUpload:function(){return Promise.all([t.e("common/vendor"),t.e("node-modules/uview-ui/components/u-upload/u-upload")]).then(t.bind(null,"f218"))},uCheckbox:function(){return t.e("node-modules/uview-ui/components/u-checkbox/u-checkbox").then(t.bind(null,"7e10a"))},uPopup:function(){return t.e("node-modules/uview-ui/components/u-popup/u-popup").then(t.bind(null,"d202"))},helangCompress:function(){return t.e("components/helang-compress/helang-compress").then(t.bind(null,"d5f6"))}},r=function(){var e=this,n=e.$createElement;e._self._c;e._isMounted||(e.e0=function(n){e.showxy=!e.showxy})},a=[]}},[["6449","common/runtime","common/vendor"]]]);